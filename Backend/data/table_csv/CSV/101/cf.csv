,12 Months Ended,12 Months Ended,12 Months Ended
,"Dec. 31, 2019","Dec. 31, 2018","Dec. 31, 2017"
"('Consolidated Statements of Cash Flows - USD ($) $ in Thousands', 'Consolidated Statements of Cash Flows - USD ($) $ in Thousands')",,,
Cash flows from operating activities:,,,
Net income (loss), 626698, -26704, -116846
Adjustments to reconcile net income (loss) to net cash provided by operating activities:,,,
Depreciation and amortization,252114,149604,113875
Amortization of deferred commissions,168014,143358,99105
Amortization of debt discount and issuance costs,33283,52733,53394
Stock-based compensation,662195,543953,394004
Deferred income taxes,-575765,-34180,-5724
Realized gain on marketable equity securities,0,-19257,0
Repayments of convertible senior notes attributable to debt discount,0,-145349,0
Other,-8921,6177,-905
"Changes in operating assets and liabilities, net of effect of business combinations:",,,
Accounts receivable,-259835,-146148,-99693
Deferred commissions,-255605,-239382,-190246
Prepaid expenses and other assets,-29907,-19886,-34288
Accounts payable,21355,-4757,-5504
Deferred revenue,537249,468856,369242
Accrued expenses and other liabilities,65097,82071,66526
Net cash provided by operating activities,1235972,811089,642940
Cash flows from investing activities:,,,
Purchases of property and equipment,-264892,-224462,-150510
"Business combinations, net of cash and restricted cash acquired",-7414,-37440,-58203
Purchases of other intangibles,-72689,-24400,-6670
Purchases of investments,-1595667,-1295782,-1194261
Sales of investments,33503,39975,85106
Maturities of investments,1159247,1194687,440590
"Realized gains on derivatives not designated as hedging instruments, net",23435,0,0
Net cash used in investing activities,-724477,-347422,-883948
Cash flows from financing activities:,,,
Net proceeds from borrowings on convertible senior notes,0,0,772127
Repayments of convertible senior notes attributable to principal,-9,-429645,-4
Proceeds from issuance of warrants,0,0,54071
Purchases of convertible note hedges,0,0,-128017
Repurchases and retirement of common stock,0,0,-55000
Proceeds from employee stock plans,107868,104160,82567
Taxes paid related to net share settlement of equity awards,-409715,-281010,-181938
Payments on financing obligations,0,-933,-4914
Net cash (used in) provided by financing activities,-301856,-607428,538892
"Foreign currency effect on cash, cash equivalents and restricted cash",-186,-15530,28013
"Net increase (decrease) in cash, cash equivalents and restricted cash",209453,-159291,325897
"Cash, cash equivalents and restricted cash at beginning of period",568538,727829,401932
"Cash, cash equivalents and restricted cash at end of period",777991,568538,727829
"Cash, cash equivalents and restricted cash at end of period:",,,
"Total cash, cash equivalents and restricted cash shown in the consolidated statement of cash flows",777991,727829,401932
Supplemental disclosures of other cash flow information:,,,
"Income taxes paid, net of refunds",20471,17507,7899
Non-cash investing and financing activities:,,,
Settlement of 2018 Notes conversion feature,0,773302,0
Benefit from exercise of 2018 Note Hedge,0,766858,0
Property and equipment included in accounts payable and accrued expenses,56966,25767,15007
Purchases of intangible assets included in accrued expenses and other liabilities, 0, 8500, 6750
