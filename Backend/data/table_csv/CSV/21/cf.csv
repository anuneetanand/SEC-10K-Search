,12 Months Ended,12 Months Ended,12 Months Ended
,"Dec. 31, 2020","Dec. 31, 2019","Dec. 31, 2018"
"('Consolidated Statements of Cash Flows - USD ($) $ in Millions', 'Consolidated Statements of Cash Flows - USD ($) $ in Millions')",,,
Cash Flows from Operating Activities,,,
Net income (loss), 862, -775, -1063
Adjustments to reconcile net income (loss) to net cash provided by operating activities:,,,
"Depreciation, amortization and impairment",2322,2154,1901
Stock-based compensation,1734,898,749
Amortization of debt discounts and issuance costs,180,188,159
Inventory and purchase commitments write-downs,202,193,85
Loss on disposals of fixed assets,117,146,162
Foreign currency transaction net loss (gain),114,-48,-2
Non-cash interest and other operating activities,228,186,49
Operating cash flow related to repayment of discounted convertible senior notes,,-188,
"Changes in operating assets and liabilities, net of effect of business combinations:",,,
Accounts receivable,-652,-367,-497
Inventory,-422,-429,-1023
Operating lease vehicles,-1072,-764,-215
Prepaid expenses and other current assets,-251,-288,-82
Other non-current assets,-344,115,-207
Accounts payable and accrued liabilities,2102,646,1797
Deferred revenue,321,801,406
Customer deposits,7,-58,-96
Other long-term liabilities,495,-5,-25
Net cash provided by operating activities,5943,2405,2098
Cash Flows from Investing Activities,,,
"Purchases of property and equipment excluding finance leases, net of sales",-3157,-1327,-2101
"Purchases of solar energy systems, net of sales",-75,-105,-218
Receipt of government grants,123,46,
Purchase of intangible assets,-10,-5,
"Business combinations, net of cash acquired",-13,-45,-18
Net cash used in investing activities,-3132,-1436,-2337
Cash Flows from Financing Activities,,,
"Proceeds from issuances of common stock in public offerings, net of issuance costs",12269,848,
Proceeds from issuances of convertible and other debt,9713,10669,6176
Repayments of convertible and other debt,-11623,-9161,-5247
Repayments of borrowings issued to related parties,,,-100
Collateralized lease repayments,-240,-389,-559
Proceeds from exercises of stock options and other stock issuances,417,263,296
Principal payments on finance leases,-338,-321,-181
Debt issuance costs,-6,-37,-15
Purchase of convertible note hedges,,-476,
Proceeds from issuance of warrants,,174,
Proceeds from investments by noncontrolling interests in subsidiaries,24,279,437
Distributions paid to noncontrolling interests in subsidiaries,-208,-311,-227
Payments for buy-outs of noncontrolling interests in subsidiaries,-35,-9,-6
Net cash provided by financing activities,9973,1529,574
Effect of exchange rate changes on cash and cash equivalents and restricted cash,334,8,-23
Net increase in cash and cash equivalents and restricted cash,13118,2506,312
"Cash and cash equivalents and restricted cash, beginning of period",6783,4277,3965
"Cash and cash equivalents and restricted cash, end of period",19901,6783,4277
Supplemental Non-Cash Investing and Financing Activities,,,
Equity issued in connection with business combination,,207,
Acquisitions of property and equipment included in liabilities,1088,562,249
Estimated fair value of facilities under build-to-suit leases,,,94
Supplemental Disclosures,,,
"Cash paid during the period for interest, net of amounts capitalized",444,455,381
"Cash paid during the period for taxes, net of refunds", 115, 54, 35
