,12 Months Ended,12 Months Ended,12 Months Ended
,"Dec. 31, 2020","Dec. 31, 2019","Dec. 31, 2018"
"('Consolidated Statements of Cash Flows - USD ($) $ in Thousands', 'Consolidated Statements of Cash Flows - USD ($) $ in Thousands')",,,
Cash flows from operating activities:,,,
Net income (loss), 118503, 626698, -26704
Adjustments to reconcile net income (loss) to net cash provided by operating activities:,,,
Depreciation and amortization,336381,252114,149604
Amortization of deferred commissions,217631,168014,143358
Amortization of debt discount and issuance costs,24478,33283,52733
Stock-based compensation,870453,662195,543953
Deferred income taxes,-24481,-575765,-34180
Repayments of convertible senior notes attributable to debt discount,-81958,0,-145349
Loss on extinguishment of debt,46611,0,0
Other,-2493,-8921,-13080
"Changes in operating assets and liabilities, net of effect of business combinations:",,,
Accounts receivable,-151431,-259835,-146148
Deferred commissions,-365264,-255605,-239382
Prepaid expenses and other assets,-54203,-29907,-19886
Accounts payable,-33583,21355,-4757
Deferred revenue,710998,537249,468856
Accrued expenses and other liabilities,174957,65097,82071
Net cash provided by operating activities,1786599,1235972,811089
Cash flows from investing activities:,,,
Purchases of property and equipment,-419327,-264892,-224462
"Business combinations, net of cash acquired",-107236,-7414,-37440
Purchases of intangibles,-13190,-72689,-24400
Purchases of investments,-2933876,-1595667,-1295782
Sales and maturities of investments,1965429,1192750,1234662
"Realized gains on derivatives not designated as hedging instruments, net",1328,23435,0
Net cash used in investing activities,-1506872,-724477,-347422
Cash flows from financing activities:,,,
Net proceeds from borrowings on 2030 Notes,1481633,0,0
Repayments of convertible senior notes attributable to principal,-1627690,-9,-429645
Net proceeds from unwind of 2022 Note Hedge,1105542,0,0
Proceeds from employee stock plans,145766,107868,104160
Taxes paid related to net share settlement of equity awards,-508604,-409715,-281010
Payments on financing obligations,0,0,-933
Net cash provided by (used in) financing activities,596647,-301856,-607428
"Foreign currency effect on cash, cash equivalents and restricted cash",25065,-186,-15530
"Net increase in cash, cash equivalents and restricted cash",901439,209453,-159291
"Cash, cash equivalents and restricted cash at beginning of period",777991,568538,727829
"Cash, cash equivalents and restricted cash at end of period",1679430,777991,568538
"Cash, cash equivalents and restricted cash at end of period:",,,
"Total cash, cash equivalents and restricted cash shown in the consolidated statement of cash flows",777991,568538,568538
Supplemental disclosures of other cash flow information:,,,
"Income taxes paid, net of refunds",39212,20471,17507
Non-cash investing and financing activities:,,,
Property and equipment included in accounts payable and accrued expenses,34839,56966,25767
Purchase of intangible assets included in accrued expenses and other liabilities,0,0,8500
2022 Note Hedge,,,
Non-cash investing and financing activities:,,,
Benefit from exercise of 2018 Note Hedge,273442,0,0
2018 Note Hedge,,,
Non-cash investing and financing activities:,,,
Benefit from exercise of 2018 Note Hedge,0,0,766858
2022 Notes,,,
Non-cash investing and financing activities:,,,
Settlement of 2018 Notes conversion feature,275273,0,0
2018 Notes,,,
Non-cash investing and financing activities:,,,
Settlement of 2018 Notes conversion feature, 0, 0, 773302
